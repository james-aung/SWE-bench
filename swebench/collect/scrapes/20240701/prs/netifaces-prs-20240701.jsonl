{"url": "https://api.github.com/repos/al45tair/netifaces/pulls/75", "id": 621002705, "node_id": "MDExOlB1bGxSZXF1ZXN0NjIxMDAyNzA1", "html_url": "https://github.com/al45tair/netifaces/pull/75", "diff_url": "https://github.com/al45tair/netifaces/pull/75.diff", "patch_url": "https://github.com/al45tair/netifaces/pull/75.patch", "issue_url": "https://api.github.com/repos/al45tair/netifaces/issues/75", "number": 75, "state": "closed", "locked": true, "title": "Added new function for getting all network interfaces at the same time", "user": {"login": "LukasMazl", "id": 37656709, "node_id": "MDQ6VXNlcjM3NjU2NzA5", "avatar_url": "https://avatars.githubusercontent.com/u/37656709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasMazl", "html_url": "https://github.com/LukasMazl", "followers_url": "https://api.github.com/users/LukasMazl/followers", "following_url": "https://api.github.com/users/LukasMazl/following{/other_user}", "gists_url": "https://api.github.com/users/LukasMazl/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasMazl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasMazl/subscriptions", "organizations_url": "https://api.github.com/users/LukasMazl/orgs", "repos_url": "https://api.github.com/users/LukasMazl/repos", "events_url": "https://api.github.com/users/LukasMazl/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasMazl/received_events", "type": "User", "site_admin": false}, "body": "Hi al45tair!\r\n\r\nI would like to share this change with you, because during of dealing with my master thesis i have found a problem with getting big amount of network interfaces. Problem which i'm dealing is described here: https://bugzilla.redhat.com/show_bug.cgi?id=1582317\r\nFor big amount of network interface it takes a long time (for 5 000 NIC it's about 7 minutes) to get all needed information (like ip, netmask etc..).  \r\n\r\nI created testing scripts which i used for creating ,,dummy\" NIC on my virtual machine and then i tested how long it takes to load all information about all available interfaces. So testing script for module Netifaces was like:\r\n`\r\nimport netifaces\r\n\r\naddrs = []\r\ninterfaces = netifaces.interfaces()\r\nfor interface in interfaces:\r\n    addrs.append(netifaces.ifaddresses(interface))\r\n`\r\nResults of tests are in the table below. The first column presents count of NIC available on my virtual machine. The second column presents how long it takes time to load all information about all NICs. (Values are in seconds)\r\n\r\n![Capture](https://user-images.githubusercontent.com/37656709/115702027-b7c50200-a368-11eb-8add-9c9101f7de4c.PNG)\r\n\r\nGraph below shows that loading all information has exponential grow:\r\n![Speed test](https://user-images.githubusercontent.com/37656709/115701556-340b1580-a368-11eb-81e1-6d87dd746175.png)\r\n\r\nAt the first time i thought that problem is already describe here https://github.com/al45tair/netifaces/issues/15, but it's not the same thing. In this pull request i have created optimization which speeds up loading names of interface about 3 time. Instead of using PySequence_Contains (..) i used dictionary, where key is name of interface and value is ,,null\" then as result is returned key set from dictionary. So this was my first try.\r\n\r\nAfter that, i found out where is the main problem. It's in the logic. Let's suppose we have PC with 1 000 NIC. Every NIC supports AF_INET, AF_INET6 and AF_PACKET. So library <ifaddrs.h>, respectively function getifaddrs (..) returns 3 000 records in the list (Windows library behaves same). \r\nNow let's see on the code i have put above. This statement ,,interfaces = netifaces.interfaces()\" does almost 3 000 iterations and returns list with size 1 000 (that's OK). Next statement is for loop where for each interface name is returned information about NIC and this informatio is added to list. Let's see closely on netifaces.ifaddresses(interface). Calling this function it makes again about 3 000 iteration, but only for one interface (because of finding interface with equal name on the input). It means that total count of iteration is 1 000 (NIC count) * 3 000 (calling netifaces.ifaddresses(..)). Therefore i have created new function called allifaddresses() which loads all information about all interfaces at the same time.  I used python3.9 so i decided to add tests for this version to travis.yml. And I added to test.py new smoke test for allifaddresses() function.\r\n\r\nAfter this change the testing results are visible below:\r\n\r\n![repair](https://user-images.githubusercontent.com/37656709/115707080-a54dc700-a36e-11eb-9457-4e1d8a437c33.PNG)\r\n\r\nThese changes were tested on Linux/windows/MacOS  and everything was OK.", "created_at": "2021-04-22T11:31:02Z", "updated_at": "2021-04-22T13:25:10Z", "closed_at": "2021-04-22T13:25:10Z", "merged_at": null, "merge_commit_sha": "633716952c8e377a8cd6b09057a178753d6e8a0b", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "draft": true, "commits_url": "https://api.github.com/repos/al45tair/netifaces/pulls/75/commits", "review_comments_url": "https://api.github.com/repos/al45tair/netifaces/pulls/75/comments", "review_comment_url": "https://api.github.com/repos/al45tair/netifaces/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/al45tair/netifaces/issues/75/comments", "statuses_url": "https://api.github.com/repos/al45tair/netifaces/statuses/f87a63fd7e8b208227f1f0af17c6748fe4047351", "head": {"label": "LukasMazl:master", "ref": "master", "sha": "f87a63fd7e8b208227f1f0af17c6748fe4047351", "user": {"login": "LukasMazl", "id": 37656709, "node_id": "MDQ6VXNlcjM3NjU2NzA5", "avatar_url": "https://avatars.githubusercontent.com/u/37656709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasMazl", "html_url": "https://github.com/LukasMazl", "followers_url": "https://api.github.com/users/LukasMazl/followers", "following_url": "https://api.github.com/users/LukasMazl/following{/other_user}", "gists_url": "https://api.github.com/users/LukasMazl/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasMazl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasMazl/subscriptions", "organizations_url": "https://api.github.com/users/LukasMazl/orgs", "repos_url": "https://api.github.com/users/LukasMazl/repos", "events_url": "https://api.github.com/users/LukasMazl/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasMazl/received_events", "type": "User", "site_admin": false}, "repo": {"id": 341831754, "node_id": "MDEwOlJlcG9zaXRvcnkzNDE4MzE3NTQ=", "name": "netifaces", "full_name": "LukasMazl/netifaces", "private": false, "owner": {"login": "LukasMazl", "id": 37656709, "node_id": "MDQ6VXNlcjM3NjU2NzA5", "avatar_url": "https://avatars.githubusercontent.com/u/37656709?v=4", "gravatar_id": "", "url": "https://api.github.com/users/LukasMazl", "html_url": "https://github.com/LukasMazl", "followers_url": "https://api.github.com/users/LukasMazl/followers", "following_url": "https://api.github.com/users/LukasMazl/following{/other_user}", "gists_url": "https://api.github.com/users/LukasMazl/gists{/gist_id}", "starred_url": "https://api.github.com/users/LukasMazl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/LukasMazl/subscriptions", "organizations_url": "https://api.github.com/users/LukasMazl/orgs", "repos_url": "https://api.github.com/users/LukasMazl/repos", "events_url": "https://api.github.com/users/LukasMazl/events{/privacy}", "received_events_url": "https://api.github.com/users/LukasMazl/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/LukasMazl/netifaces", "description": null, "fork": true, "url": "https://api.github.com/repos/LukasMazl/netifaces", "forks_url": "https://api.github.com/repos/LukasMazl/netifaces/forks", "keys_url": "https://api.github.com/repos/LukasMazl/netifaces/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/LukasMazl/netifaces/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/LukasMazl/netifaces/teams", "hooks_url": "https://api.github.com/repos/LukasMazl/netifaces/hooks", "issue_events_url": "https://api.github.com/repos/LukasMazl/netifaces/issues/events{/number}", "events_url": "https://api.github.com/repos/LukasMazl/netifaces/events", "assignees_url": "https://api.github.com/repos/LukasMazl/netifaces/assignees{/user}", "branches_url": "https://api.github.com/repos/LukasMazl/netifaces/branches{/branch}", "tags_url": "https://api.github.com/repos/LukasMazl/netifaces/tags", "blobs_url": "https://api.github.com/repos/LukasMazl/netifaces/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/LukasMazl/netifaces/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/LukasMazl/netifaces/git/refs{/sha}", "trees_url": "https://api.github.com/repos/LukasMazl/netifaces/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/LukasMazl/netifaces/statuses/{sha}", "languages_url": "https://api.github.com/repos/LukasMazl/netifaces/languages", "stargazers_url": "https://api.github.com/repos/LukasMazl/netifaces/stargazers", "contributors_url": "https://api.github.com/repos/LukasMazl/netifaces/contributors", "subscribers_url": "https://api.github.com/repos/LukasMazl/netifaces/subscribers", "subscription_url": "https://api.github.com/repos/LukasMazl/netifaces/subscription", "commits_url": "https://api.github.com/repos/LukasMazl/netifaces/commits{/sha}", "git_commits_url": "https://api.github.com/repos/LukasMazl/netifaces/git/commits{/sha}", "comments_url": "https://api.github.com/repos/LukasMazl/netifaces/comments{/number}", "issue_comment_url": "https://api.github.com/repos/LukasMazl/netifaces/issues/comments{/number}", "contents_url": "https://api.github.com/repos/LukasMazl/netifaces/contents/{+path}", "compare_url": "https://api.github.com/repos/LukasMazl/netifaces/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/LukasMazl/netifaces/merges", "archive_url": "https://api.github.com/repos/LukasMazl/netifaces/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/LukasMazl/netifaces/downloads", "issues_url": "https://api.github.com/repos/LukasMazl/netifaces/issues{/number}", "pulls_url": "https://api.github.com/repos/LukasMazl/netifaces/pulls{/number}", "milestones_url": "https://api.github.com/repos/LukasMazl/netifaces/milestones{/number}", "notifications_url": "https://api.github.com/repos/LukasMazl/netifaces/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/LukasMazl/netifaces/labels{/name}", "releases_url": "https://api.github.com/repos/LukasMazl/netifaces/releases{/id}", "deployments_url": "https://api.github.com/repos/LukasMazl/netifaces/deployments", "created_at": "2021-02-24T08:33:53Z", "updated_at": "2021-04-22T09:51:21Z", "pushed_at": "2021-04-22T13:17:19Z", "git_url": "git://github.com/LukasMazl/netifaces.git", "ssh_url": "git@github.com:LukasMazl/netifaces.git", "clone_url": "https://github.com/LukasMazl/netifaces.git", "svn_url": "https://github.com/LukasMazl/netifaces", "homepage": null, "size": 213, "stargazers_count": 0, "watchers_count": 0, "language": "C", "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": false, "forks_count": 0, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 0, "license": {"key": "mit", "name": "MIT License", "spdx_id": "MIT", "url": "https://api.github.com/licenses/mit", "node_id": "MDc6TGljZW5zZTEz"}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 0, "open_issues": 0, "watchers": 0, "default_branch": "master"}}, "base": {"label": "al45tair:master", "ref": "master", "sha": "8b0d75750543453cdc8680bc52d4240eb4de2636", "user": {"login": "al45tair", "id": 2750072, "node_id": "MDQ6VXNlcjI3NTAwNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/2750072?v=4", "gravatar_id": "", "url": "https://api.github.com/users/al45tair", "html_url": "https://github.com/al45tair", "followers_url": "https://api.github.com/users/al45tair/followers", "following_url": "https://api.github.com/users/al45tair/following{/other_user}", "gists_url": "https://api.github.com/users/al45tair/gists{/gist_id}", "starred_url": "https://api.github.com/users/al45tair/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/al45tair/subscriptions", "organizations_url": "https://api.github.com/users/al45tair/orgs", "repos_url": "https://api.github.com/users/al45tair/repos", "events_url": "https://api.github.com/users/al45tair/events{/privacy}", "received_events_url": "https://api.github.com/users/al45tair/received_events", "type": "User", "site_admin": false}, "repo": {"id": 96518142, "node_id": "MDEwOlJlcG9zaXRvcnk5NjUxODE0Mg==", "name": "netifaces", "full_name": "al45tair/netifaces", "private": false, "owner": {"login": "al45tair", "id": 2750072, "node_id": "MDQ6VXNlcjI3NTAwNzI=", "avatar_url": "https://avatars.githubusercontent.com/u/2750072?v=4", "gravatar_id": "", "url": "https://api.github.com/users/al45tair", "html_url": "https://github.com/al45tair", "followers_url": "https://api.github.com/users/al45tair/followers", "following_url": "https://api.github.com/users/al45tair/following{/other_user}", "gists_url": "https://api.github.com/users/al45tair/gists{/gist_id}", "starred_url": "https://api.github.com/users/al45tair/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/al45tair/subscriptions", "organizations_url": "https://api.github.com/users/al45tair/orgs", "repos_url": "https://api.github.com/users/al45tair/repos", "events_url": "https://api.github.com/users/al45tair/events{/privacy}", "received_events_url": "https://api.github.com/users/al45tair/received_events", "type": "User", "site_admin": false}, "html_url": "https://github.com/al45tair/netifaces", "description": null, "fork": false, "url": "https://api.github.com/repos/al45tair/netifaces", "forks_url": "https://api.github.com/repos/al45tair/netifaces/forks", "keys_url": "https://api.github.com/repos/al45tair/netifaces/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/al45tair/netifaces/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/al45tair/netifaces/teams", "hooks_url": "https://api.github.com/repos/al45tair/netifaces/hooks", "issue_events_url": "https://api.github.com/repos/al45tair/netifaces/issues/events{/number}", "events_url": "https://api.github.com/repos/al45tair/netifaces/events", "assignees_url": "https://api.github.com/repos/al45tair/netifaces/assignees{/user}", "branches_url": "https://api.github.com/repos/al45tair/netifaces/branches{/branch}", "tags_url": "https://api.github.com/repos/al45tair/netifaces/tags", "blobs_url": "https://api.github.com/repos/al45tair/netifaces/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/al45tair/netifaces/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/al45tair/netifaces/git/refs{/sha}", "trees_url": "https://api.github.com/repos/al45tair/netifaces/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/al45tair/netifaces/statuses/{sha}", "languages_url": "https://api.github.com/repos/al45tair/netifaces/languages", "stargazers_url": "https://api.github.com/repos/al45tair/netifaces/stargazers", "contributors_url": "https://api.github.com/repos/al45tair/netifaces/contributors", "subscribers_url": "https://api.github.com/repos/al45tair/netifaces/subscribers", "subscription_url": "https://api.github.com/repos/al45tair/netifaces/subscription", "commits_url": "https://api.github.com/repos/al45tair/netifaces/commits{/sha}", "git_commits_url": "https://api.github.com/repos/al45tair/netifaces/git/commits{/sha}", "comments_url": "https://api.github.com/repos/al45tair/netifaces/comments{/number}", "issue_comment_url": "https://api.github.com/repos/al45tair/netifaces/issues/comments{/number}", "contents_url": "https://api.github.com/repos/al45tair/netifaces/contents/{+path}", "compare_url": "https://api.github.com/repos/al45tair/netifaces/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/al45tair/netifaces/merges", "archive_url": "https://api.github.com/repos/al45tair/netifaces/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/al45tair/netifaces/downloads", "issues_url": "https://api.github.com/repos/al45tair/netifaces/issues{/number}", "pulls_url": "https://api.github.com/repos/al45tair/netifaces/pulls{/number}", "milestones_url": "https://api.github.com/repos/al45tair/netifaces/milestones{/number}", "notifications_url": "https://api.github.com/repos/al45tair/netifaces/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/al45tair/netifaces/labels{/name}", "releases_url": "https://api.github.com/repos/al45tair/netifaces/releases{/id}", "deployments_url": "https://api.github.com/repos/al45tair/netifaces/deployments", "created_at": "2017-07-07T08:39:41Z", "updated_at": "2024-08-21T12:33:49Z", "pushed_at": "2021-05-31T10:22:31Z", "git_url": "git://github.com/al45tair/netifaces.git", "ssh_url": "git@github.com:al45tair/netifaces.git", "clone_url": "https://github.com/al45tair/netifaces.git", "svn_url": "https://github.com/al45tair/netifaces", "homepage": null, "size": 143, "stargazers_count": 325, "watchers_count": 325, "language": "C", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": false, "forks_count": 80, "mirror_url": null, "archived": true, "disabled": false, "open_issues_count": 34, "license": {"key": "mit", "name": "MIT License", "spdx_id": "MIT", "url": "https://api.github.com/licenses/mit", "node_id": "MDc6TGljZW5zZTEz"}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 80, "open_issues": 34, "watchers": 325, "default_branch": "master"}}, "_links": {"self": {"href": "https://api.github.com/repos/al45tair/netifaces/pulls/75"}, "html": {"href": "https://github.com/al45tair/netifaces/pull/75"}, "issue": {"href": "https://api.github.com/repos/al45tair/netifaces/issues/75"}, "comments": {"href": "https://api.github.com/repos/al45tair/netifaces/issues/75/comments"}, "review_comments": {"href": "https://api.github.com/repos/al45tair/netifaces/pulls/75/comments"}, "review_comment": {"href": "https://api.github.com/repos/al45tair/netifaces/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/al45tair/netifaces/pulls/75/commits"}, "statuses": {"href": "https://api.github.com/repos/al45tair/netifaces/statuses/f87a63fd7e8b208227f1f0af17c6748fe4047351"}}, "author_association": "NONE", "auto_merge": null, "active_lock_reason": null, "resolved_issues": []}
