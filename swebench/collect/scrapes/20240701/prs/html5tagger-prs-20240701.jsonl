{"url": "https://api.github.com/repos/sanic-org/html5tagger/pulls/11", "id": 1643155751, "node_id": "PR_kwDODrlg785h8JEn", "html_url": "https://github.com/sanic-org/html5tagger/pull/11", "diff_url": "https://github.com/sanic-org/html5tagger/pull/11.diff", "patch_url": "https://github.com/sanic-org/html5tagger/pull/11.patch", "issue_url": "https://api.github.com/repos/sanic-org/html5tagger/issues/11", "number": 11, "state": "closed", "locked": false, "title": "Inline Style Approach Proposal", "user": {"login": "tlonny", "id": 45770124, "node_id": "MDQ6VXNlcjQ1NzcwMTI0", "avatar_url": "https://avatars.githubusercontent.com/u/45770124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tlonny", "html_url": "https://github.com/tlonny", "followers_url": "https://api.github.com/users/tlonny/followers", "following_url": "https://api.github.com/users/tlonny/following{/other_user}", "gists_url": "https://api.github.com/users/tlonny/gists{/gist_id}", "starred_url": "https://api.github.com/users/tlonny/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tlonny/subscriptions", "organizations_url": "https://api.github.com/users/tlonny/orgs", "repos_url": "https://api.github.com/users/tlonny/repos", "events_url": "https://api.github.com/users/tlonny/events{/privacy}", "received_events_url": "https://api.github.com/users/tlonny/received_events", "type": "User", "site_admin": false}, "body": "## Overview\r\n\r\nThis approach allows users to define desired styles (these styles can be dynamic and templated using f-strings), with the library returning a unique class name to reference. A caching strategy ensures redundant styles aren't defined multiple times under different class names.\r\n\r\n## Implementation\r\n\r\nSpecifically, we introduce the concept of a \"Style Lambda\". This is a function that takes a class name as input, and returns a valid inline style. For example:\r\n\r\n```python\r\n    return lambda cls: f\"\"\"\r\n        .{cls} {{ background-color: red; }}\r\n        .{cls}:hover {{ background-color: blue; }}\r\n    \"\"\"\r\n```\r\n\r\nThese style lambdas can be made dynamic/parameterized by turning them into closures:\r\n\r\n```python\r\ndef hover_style(regular_color, hover_color):\r\n    return lambda cls: f\"\"\"\r\n        .{cls} {{ background-color: {regular_color}; }}\r\n        .{cls}:hover {{ background-color: {hover_color}; }}\r\n    \"\"\"\r\n```\r\n\r\nNow we can generate style lambdas with the color/hover color of our choice.\r\n\r\nWe can pass these style lambdas into `doc._class` and:\r\n  - A class name with the style attributes specified by the lambda will be returned.\r\n  - An inline style tag will be added if one doesn't already exist\r\n\r\nThe decision to explicitly pass the class name as an argument to the lambda allows us to easily make use of things like hover selectors, media queries etc:\r\n\r\n```python\r\ndef crazy_style(regular_color, hover_color):\r\n    return lambda cls: f\"\"\"\r\n        .{cls} {{ background-color: {regular_color}; }}\r\n        .{cls}:hover {{ background-color: {hover_color}; }}\r\n        @media(max-width: 600px) {{\r\n            .{cls} {{ display: none; }}\r\n        }}\r\n    \"\"\"\r\n```\r\n\r\n## Example\r\n\r\nI've taken the example present in the `README.md` and modified it to show the approach in action:\r\n\r\n```python\r\nfrom html5tagger import Document, E\r\n\r\n# Create a document\r\ndoc = Document(\r\n    E.TitleText_,           # The first argument is for <title>, adding variable TitleText\r\n    lang=\"en\",              # Keyword arguments for <html> attributes\r\n\r\n    # Just list the resources you need, no need to remember link/script tags\r\n    _urls=[ \"style.css\", \"favicon.png\", \"manifest.json\" ]\r\n)\r\n\r\ndef hover_style(regular_color, hover_color):\r\n    return lambda cls: f\"\"\"\r\n        .{cls} {{ background-color: {regular_color}; }}\r\n        .{cls}:hover {{ background-color: {hover_color}; }}\r\n    \"\"\"\r\n\r\n# Upper case names are template variables. You can modify them later.\r\ndoc.Head_\r\ncls_1 = doc._class(hover_style(\"blue\", \"green\"))\r\ndoc.h1(class_ = cls_1).TitleText_(\"Demo\")   # Goes inside <h1> and updates <title> as well\r\n\r\n# This has been a hard problem for DOM other such generators:\r\ncls_2 = doc._class(hover_style(\"red\", \"blue\"))\r\ndoc.p(\"A paragraph with \", class_ = cls_2).a(\"a link\", href=\"/files\")(\" and \").em(\"formatting\")\r\n\r\n# Use with for complex nesting (not often needed)\r\nwith doc.table(id=\"data\"):\r\n    doc.tr.th(\"First\").th(\"Second\").th(\"Third\")\r\n    doc.TableRows_\r\n\r\n# Let's add something to the template variables\r\ndoc.Head._script(\"console.log('</script> escaping is weird')\")\r\n\r\ntable = doc.TableRows\r\nfor row in range(10):\r\n    table.tr\r\n    for col in range(3):\r\n        table.td(row * col)\r\n\r\n# Or remove the table data we just added\r\ndoc.TableRows = None\r\nprint(str(doc))\r\n```\r\n\r\nNow results in:\r\n\r\n![image](https://github.com/sanic-org/html5tagger/assets/45770124/90fcbd99-a078-4607-8888-f99d9ff0d087)\r\n\r\nWith HTML:\r\n\r\n```html\r\n<!DOCTYPE html>\r\n<html lang=en>\r\n   <meta charset=\"utf-8\">\r\n   <title>Demo</title>\r\n   <link href=\"style.css\" rel=stylesheet>\r\n   <link href=\"favicon.png\" rel=icon type=\"image/png\">\r\n   <link href=\"manifest.json\" rel=manifest>\r\n   <script>console.log('<\\/script> escaping is weird')</script>\r\n   <style-class-names></style-class-names>\r\n   <style>\r\n      .cls-902e763b7b6290cc7adc125eb664584b { background-color: blue; }\r\n      .cls-902e763b7b6290cc7adc125eb664584b:hover { background-color: green; }\r\n   </style>\r\n   <h1 class=\"cls-902e763b7b6290cc7adc125eb664584b\">Demo</h1>\r\n   <style-class-names></style-class-names>\r\n   <style>\r\n      .cls-057c82844b2c60f6b476a20a34d5a9ef { background-color: red; }\r\n      .cls-057c82844b2c60f6b476a20a34d5a9ef:hover { background-color: blue; }\r\n   </style>\r\n   <p class=\"cls-057c82844b2c60f6b476a20a34d5a9ef\">A paragraph with <a href=\"/files\">a link</a> and <em>formatting</em>\r\n   <table id=data>\r\n      <tr>\r\n         <th>First\r\n         <th>Second\r\n         <th>Third\r\n   </table>\r\n```\r\n", "created_at": "2023-12-13T21:40:18Z", "updated_at": "2024-04-18T10:43:00Z", "closed_at": "2024-04-18T10:43:00Z", "merged_at": null, "merge_commit_sha": "b88b3ce9b89a29673bd28fbbf217c285dfc25a5a", "assignee": null, "assignees": [], "requested_reviewers": [], "requested_teams": [], "labels": [], "milestone": null, "draft": true, "commits_url": "https://api.github.com/repos/sanic-org/html5tagger/pulls/11/commits", "review_comments_url": "https://api.github.com/repos/sanic-org/html5tagger/pulls/11/comments", "review_comment_url": "https://api.github.com/repos/sanic-org/html5tagger/pulls/comments{/number}", "comments_url": "https://api.github.com/repos/sanic-org/html5tagger/issues/11/comments", "statuses_url": "https://api.github.com/repos/sanic-org/html5tagger/statuses/59c952db023877e178e7ba387d509ba071362152", "head": {"label": "tlonny:main", "ref": "main", "sha": "59c952db023877e178e7ba387d509ba071362152", "user": {"login": "tlonny", "id": 45770124, "node_id": "MDQ6VXNlcjQ1NzcwMTI0", "avatar_url": "https://avatars.githubusercontent.com/u/45770124?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tlonny", "html_url": "https://github.com/tlonny", "followers_url": "https://api.github.com/users/tlonny/followers", "following_url": "https://api.github.com/users/tlonny/following{/other_user}", "gists_url": "https://api.github.com/users/tlonny/gists{/gist_id}", "starred_url": "https://api.github.com/users/tlonny/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tlonny/subscriptions", "organizations_url": "https://api.github.com/users/tlonny/orgs", "repos_url": "https://api.github.com/users/tlonny/repos", "events_url": "https://api.github.com/users/tlonny/events{/privacy}", "received_events_url": "https://api.github.com/users/tlonny/received_events", "type": "User", "site_admin": false}, "repo": null}, "base": {"label": "sanic-org:main", "ref": "main", "sha": "ef9e01b38f5bd064f3f8d061632df7937c0ae738", "user": {"login": "sanic-org", "id": 25215992, "node_id": "MDEyOk9yZ2FuaXphdGlvbjI1MjE1OTky", "avatar_url": "https://avatars.githubusercontent.com/u/25215992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanic-org", "html_url": "https://github.com/sanic-org", "followers_url": "https://api.github.com/users/sanic-org/followers", "following_url": "https://api.github.com/users/sanic-org/following{/other_user}", "gists_url": "https://api.github.com/users/sanic-org/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanic-org/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanic-org/subscriptions", "organizations_url": "https://api.github.com/users/sanic-org/orgs", "repos_url": "https://api.github.com/users/sanic-org/repos", "events_url": "https://api.github.com/users/sanic-org/events{/privacy}", "received_events_url": "https://api.github.com/users/sanic-org/received_events", "type": "Organization", "site_admin": false}, "repo": {"id": 247029999, "node_id": "MDEwOlJlcG9zaXRvcnkyNDcwMjk5OTk=", "name": "html5tagger", "full_name": "sanic-org/html5tagger", "private": false, "owner": {"login": "sanic-org", "id": 25215992, "node_id": "MDEyOk9yZ2FuaXphdGlvbjI1MjE1OTky", "avatar_url": "https://avatars.githubusercontent.com/u/25215992?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sanic-org", "html_url": "https://github.com/sanic-org", "followers_url": "https://api.github.com/users/sanic-org/followers", "following_url": "https://api.github.com/users/sanic-org/following{/other_user}", "gists_url": "https://api.github.com/users/sanic-org/gists{/gist_id}", "starred_url": "https://api.github.com/users/sanic-org/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sanic-org/subscriptions", "organizations_url": "https://api.github.com/users/sanic-org/orgs", "repos_url": "https://api.github.com/users/sanic-org/repos", "events_url": "https://api.github.com/users/sanic-org/events{/privacy}", "received_events_url": "https://api.github.com/users/sanic-org/received_events", "type": "Organization", "site_admin": false}, "html_url": "https://github.com/sanic-org/html5tagger", "description": "Create HTML documents from Python", "fork": false, "url": "https://api.github.com/repos/sanic-org/html5tagger", "forks_url": "https://api.github.com/repos/sanic-org/html5tagger/forks", "keys_url": "https://api.github.com/repos/sanic-org/html5tagger/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/sanic-org/html5tagger/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/sanic-org/html5tagger/teams", "hooks_url": "https://api.github.com/repos/sanic-org/html5tagger/hooks", "issue_events_url": "https://api.github.com/repos/sanic-org/html5tagger/issues/events{/number}", "events_url": "https://api.github.com/repos/sanic-org/html5tagger/events", "assignees_url": "https://api.github.com/repos/sanic-org/html5tagger/assignees{/user}", "branches_url": "https://api.github.com/repos/sanic-org/html5tagger/branches{/branch}", "tags_url": "https://api.github.com/repos/sanic-org/html5tagger/tags", "blobs_url": "https://api.github.com/repos/sanic-org/html5tagger/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/sanic-org/html5tagger/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/sanic-org/html5tagger/git/refs{/sha}", "trees_url": "https://api.github.com/repos/sanic-org/html5tagger/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/sanic-org/html5tagger/statuses/{sha}", "languages_url": "https://api.github.com/repos/sanic-org/html5tagger/languages", "stargazers_url": "https://api.github.com/repos/sanic-org/html5tagger/stargazers", "contributors_url": "https://api.github.com/repos/sanic-org/html5tagger/contributors", "subscribers_url": "https://api.github.com/repos/sanic-org/html5tagger/subscribers", "subscription_url": "https://api.github.com/repos/sanic-org/html5tagger/subscription", "commits_url": "https://api.github.com/repos/sanic-org/html5tagger/commits{/sha}", "git_commits_url": "https://api.github.com/repos/sanic-org/html5tagger/git/commits{/sha}", "comments_url": "https://api.github.com/repos/sanic-org/html5tagger/comments{/number}", "issue_comment_url": "https://api.github.com/repos/sanic-org/html5tagger/issues/comments{/number}", "contents_url": "https://api.github.com/repos/sanic-org/html5tagger/contents/{+path}", "compare_url": "https://api.github.com/repos/sanic-org/html5tagger/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/sanic-org/html5tagger/merges", "archive_url": "https://api.github.com/repos/sanic-org/html5tagger/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/sanic-org/html5tagger/downloads", "issues_url": "https://api.github.com/repos/sanic-org/html5tagger/issues{/number}", "pulls_url": "https://api.github.com/repos/sanic-org/html5tagger/pulls{/number}", "milestones_url": "https://api.github.com/repos/sanic-org/html5tagger/milestones{/number}", "notifications_url": "https://api.github.com/repos/sanic-org/html5tagger/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/sanic-org/html5tagger/labels{/name}", "releases_url": "https://api.github.com/repos/sanic-org/html5tagger/releases{/id}", "deployments_url": "https://api.github.com/repos/sanic-org/html5tagger/deployments", "created_at": "2020-03-13T09:08:58Z", "updated_at": "2024-08-15T02:12:13Z", "pushed_at": "2023-12-13T21:40:19Z", "git_url": "git://github.com/sanic-org/html5tagger.git", "ssh_url": "git@github.com:sanic-org/html5tagger.git", "clone_url": "https://github.com/sanic-org/html5tagger.git", "svn_url": "https://github.com/sanic-org/html5tagger", "homepage": null, "size": 69, "stargazers_count": 29, "watchers_count": 29, "language": "Python", "has_issues": true, "has_projects": true, "has_downloads": true, "has_wiki": true, "has_pages": false, "has_discussions": false, "forks_count": 4, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 3, "license": {"key": "unlicense", "name": "The Unlicense", "spdx_id": "Unlicense", "url": "https://api.github.com/licenses/unlicense", "node_id": "MDc6TGljZW5zZTE1"}, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 4, "open_issues": 3, "watchers": 29, "default_branch": "main"}}, "_links": {"self": {"href": "https://api.github.com/repos/sanic-org/html5tagger/pulls/11"}, "html": {"href": "https://github.com/sanic-org/html5tagger/pull/11"}, "issue": {"href": "https://api.github.com/repos/sanic-org/html5tagger/issues/11"}, "comments": {"href": "https://api.github.com/repos/sanic-org/html5tagger/issues/11/comments"}, "review_comments": {"href": "https://api.github.com/repos/sanic-org/html5tagger/pulls/11/comments"}, "review_comment": {"href": "https://api.github.com/repos/sanic-org/html5tagger/pulls/comments{/number}"}, "commits": {"href": "https://api.github.com/repos/sanic-org/html5tagger/pulls/11/commits"}, "statuses": {"href": "https://api.github.com/repos/sanic-org/html5tagger/statuses/59c952db023877e178e7ba387d509ba071362152"}}, "author_association": "NONE", "auto_merge": null, "active_lock_reason": null, "resolved_issues": []}
